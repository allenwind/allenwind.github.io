<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="你好，世界！"><title>常用Linux技巧总结 | Mr.Feng Blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">常用Linux技巧总结</h1><a id="logo" href="/blog/.">Mr.Feng Blog</a><p class="description">NLP、深度学习、机器学习、Python、Go</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/blog/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">常用Linux技巧总结</h1><div class="post-meta">Jul 25, 2018<span> | </span><span class="category"><a href="/blog/categories/Linux/">Linux</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#实用技巧和工具"><span class="toc-number">1.</span> <span class="toc-text">实用技巧和工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ssh自动登录"><span class="toc-number">1.1.</span> <span class="toc-text">ssh自动登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置命令行的超时"><span class="toc-number">1.2.</span> <span class="toc-text">设置命令行的超时</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络流量查看"><span class="toc-number">1.3.</span> <span class="toc-text">网络流量查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#目录查看和分析"><span class="toc-number">1.4.</span> <span class="toc-text">目录查看和分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后台和系统"><span class="toc-number">2.</span> <span class="toc-text">后台和系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#systemd相关命令总结"><span class="toc-number">2.1.</span> <span class="toc-text">systemd相关命令总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jobs"><span class="toc-number">2.2.</span> <span class="toc-text">jobs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进程相关"><span class="toc-number">2.3.</span> <span class="toc-text">进程相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#硬件或驱动程序的信息dmesg"><span class="toc-number">2.4.</span> <span class="toc-text">硬件或驱动程序的信息dmesg</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#调试与分析"><span class="toc-number">3.</span> <span class="toc-text">调试与分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件"><span class="toc-number">4.</span> <span class="toc-text">文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通配符"><span class="toc-number">4.1.</span> <span class="toc-text">通配符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件操作"><span class="toc-number">4.2.</span> <span class="toc-text">文件操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建文件"><span class="toc-number">4.3.</span> <span class="toc-text">创建文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查找命令"><span class="toc-number">4.4.</span> <span class="toc-text">查找命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apt包"><span class="toc-number">4.5.</span> <span class="toc-text">apt包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yum"><span class="toc-number">4.6.</span> <span class="toc-text">yum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件防伪"><span class="toc-number">4.7.</span> <span class="toc-text">文件防伪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#压缩与解压"><span class="toc-number">4.8.</span> <span class="toc-text">压缩与解压</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络操作"><span class="toc-number">5.</span> <span class="toc-text">网络操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#net-tools网络工具"><span class="toc-number">5.1.</span> <span class="toc-text">net-tools网络工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iproute2套装工具"><span class="toc-number">5.2.</span> <span class="toc-text">iproute2套装工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS有关的操作"><span class="toc-number">5.3.</span> <span class="toc-text">DNS有关的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsync"><span class="toc-number">5.4.</span> <span class="toc-text">rsync</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#curl-amp-wget"><span class="toc-number">5.5.</span> <span class="toc-text">curl &amp; wget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssh相关"><span class="toc-number">5.6.</span> <span class="toc-text">ssh相关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#日志和数据处理"><span class="toc-number">6.</span> <span class="toc-text">日志和数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#awk"><span class="toc-number">6.1.</span> <span class="toc-text">awk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sed"><span class="toc-number">6.2.</span> <span class="toc-text">sed</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="post-content"><p>总结常用的Linux命令~</p>
<a id="more"></a>
<h2 id="实用技巧和工具"><a href="#实用技巧和工具" class="headerlink" title="实用技巧和工具"></a>实用技巧和工具</h2><h3 id="ssh自动登录"><a href="#ssh自动登录" class="headerlink" title="ssh自动登录"></a>ssh自动登录</h3><p>sshpass</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshpass -p <span class="string">'password'</span> /usr/bin/ssh -o <span class="string">"StrictHostKeyChecking no"</span>  -o <span class="string">"UserKnownHostsFile /dev/null"</span> root@192.168.1.8</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> loginroot1=<span class="string">'sshpass -p '</span>password<span class="string">' /usr/bin/ssh -o "StrictHostKeyChecking no"  -o "UserKnownHostsFile /dev/null" root@192.168.1.1'</span></span><br></pre></td></tr></table></figure>
<h3 id="设置命令行的超时"><a href="#设置命令行的超时" class="headerlink" title="设置命令行的超时"></a>设置命令行的超时</h3><p>timeout设置命令行的超时，如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timeout 60s ping jd.com</span><br></pre></td></tr></table></figure>
<h3 id="网络流量查看"><a href="#网络流量查看" class="headerlink" title="网络流量查看"></a>网络流量查看</h3><p>非UI环境下，实时查看网络流量nload，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nload</span><br></pre></td></tr></table></figure>
<p>通过<code>↑↓</code>键切换设备。</p>
<p>实时查看进程流量nethogs，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nethogs</span><br></pre></td></tr></table></figure>
<h3 id="目录查看和分析"><a href="#目录查看和分析" class="headerlink" title="目录查看和分析"></a>目录查看和分析</h3><p>Ubuntu系统下，有一个目录浏览的UI工具，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nautilus <span class="variable">$&#123;your_dir&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果要分析目录的使用情况，baobab是不错的工具，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baobab <span class="variable">$&#123;your_dir&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果是命令行环境，推荐使用ncdu，例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ncdu <span class="variable">$HOME</span>/desktop</span><br><span class="line"></span><br><span class="line">--- /desktop --------------------------------------------------------------------------------</span><br><span class="line">    5.3 GiB [<span class="comment">##########] /a                                                                          </span></span><br><span class="line">    2.4 GiB [<span class="comment">####      ] /b</span></span><br><span class="line">  806.6 MiB [<span class="comment">#         ] /c</span></span><br><span class="line">  508.3 MiB [          ] /d</span><br></pre></td></tr></table></figure>
<h2 id="后台和系统"><a href="#后台和系统" class="headerlink" title="后台和系统"></a>后台和系统</h2><p>Target就是一个包含许多相关Unit的组</p>
<p>编写systemd配置文件，以sshd为例，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[Unit] <span class="comment"># 用来定义 Unit 的元数据</span></span><br><span class="line">Description=OpenSSH server daemon <span class="comment"># 简短描述</span></span><br><span class="line">Documentation=man:sshd(8) man:sshd_config(5)</span><br><span class="line">After=network.target sshd-keygen.service <span class="comment"># 如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之前启动</span></span><br><span class="line">Wants=sshd-keygen.service <span class="comment"># 与当前 Unit 配合的其他 Unit，如果它们没有运行，当前 Unit 不会启动失败</span></span><br><span class="line">Requires= <span class="comment"># 当前 Unit 依赖的其他 Unit，如果它们没有运行，当前 Unit 会启动失败，是一种强依赖，即如果该服务启动失败或异常退出，本服务也退出。</span></span><br><span class="line">Before= <span class="comment"># 如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之后启动</span></span><br><span class="line"></span><br><span class="line">[Service] <span class="comment"># 用来 Service 的配置，只有 Service 类型的 Unit 才有这个区块</span></span><br><span class="line">EnvironmentFile=/etc/sysconfig/sshd <span class="comment"># 指定当前服务的环境参数文件</span></span><br><span class="line">ExecStart=/usr/sbin/sshd -D <span class="variable">$OPTIONS</span> <span class="comment"># 定义启动进程时执行的命令</span></span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -HUP <span class="variable">$MAINPID</span> <span class="comment"># 重启服务时执行的命令</span></span><br><span class="line">Type=simple</span><br><span class="line">KillMode=process</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=42s</span><br><span class="line"></span><br><span class="line">[Install] <span class="comment"># 定义如何安装这个配置文件</span></span><br><span class="line">WantedBy=multi-user.target <span class="comment"># 说明sshd 所在的 Target 是multi-user.target</span></span><br></pre></td></tr></table></figure>
<h3 id="systemd相关命令总结"><a href="#systemd相关命令总结" class="headerlink" title="systemd相关命令总结"></a>systemd相关命令总结</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> <span class="variable">$&#123;service&#125;</span> <span class="comment"># 允许开机启动服务，即建立启动链接/usr/lib/systemd/system/-&gt;/etc/systemd/system/</span></span><br><span class="line">systemctl <span class="built_in">disable</span> <span class="variable">$&#123;service&#125;</span> <span class="comment"># 取消开机启动，即取消建立启动链接</span></span><br><span class="line">systemctl stop <span class="variable">$&#123;service&#125;</span> <span class="comment"># 停止服务</span></span><br><span class="line">systemctl start <span class="variable">$&#123;service&#125;</span> <span class="comment"># 启动服务</span></span><br><span class="line">systemctl <span class="built_in">kill</span> <span class="variable">$&#123;service&#125;</span> <span class="comment"># 杀掉，处理卡死情况</span></span><br><span class="line">systemctl restart <span class="variable">$&#123;service&#125;</span> <span class="comment"># 重启服务，修改配置后</span></span><br><span class="line">systemctl reload <span class="variable">$&#123;service&#125;</span> <span class="comment"># 重新加载service的配置文件</span></span><br><span class="line">systemctl cat <span class="variable">$&#123;service&#125;</span> <span class="comment"># 查看service的配置文件</span></span><br><span class="line">systemctl daemon-reload <span class="comment"># reload所有修改过的配置文件</span></span><br><span class="line">systemctl status <span class="variable">$&#123;service&#125;</span> <span class="comment"># 显示状态，不加service显示系统状态</span></span><br><span class="line">systemctl list-dependencies <span class="variable">$&#123;service&#125;</span> <span class="comment"># 依赖关系</span></span><br><span class="line">systemctl list-unit-files <span class="comment"># 列出所有配置文件</span></span><br><span class="line">systemctl list-unit-files --<span class="built_in">type</span>=service <span class="comment"># 列出所有service配置文件</span></span><br><span class="line">systemctl list-units</span><br><span class="line">systemd-analyze blame <span class="comment"># 查看每个服务的启动耗时</span></span><br><span class="line">hostnamectl <span class="comment"># 主机信息</span></span><br><span class="line">localectl <span class="comment"># 查看本地化设置</span></span><br><span class="line">timedatectl <span class="comment"># 查看当前时区设置</span></span><br><span class="line">loginctl list-users <span class="comment"># 列出当前登录用户</span></span><br><span class="line">loginctl list-sessions <span class="comment"># 列出当前session</span></span><br></pre></td></tr></table></figure>
<h3 id="jobs"><a href="#jobs" class="headerlink" title="jobs"></a>jobs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ping $&#123;IP&#125;</span><br><span class="line">Ctrl + Z</span><br><span class="line">jobs</span><br><span class="line">fg</span><br></pre></td></tr></table></figure>
<h3 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a>进程相关</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ps aux | sort -nk +4 | tail <span class="comment"># 列出头十个最耗内存的进程</span></span><br><span class="line">pstree</span><br><span class="line">nohup</span><br><span class="line">top</span><br><span class="line">htop</span><br><span class="line">iostat</span><br><span class="line">dstat <span class="comment"># 网络、CPU、DSK</span></span><br></pre></td></tr></table></figure>
<h3 id="硬件或驱动程序的信息dmesg"><a href="#硬件或驱动程序的信息dmesg" class="headerlink" title="硬件或驱动程序的信息dmesg"></a>硬件或驱动程序的信息dmesg</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmidecode -t memory <span class="comment"># 内存信息</span></span><br></pre></td></tr></table></figure>
<p>t参数还可以取bios/system/baseboard/chassis/processor/memory/cache/connector/slot</p>
<h2 id="调试与分析"><a href="#调试与分析" class="headerlink" title="调试与分析"></a>调试与分析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ltrace</span><br><span class="line">gdb</span><br></pre></td></tr></table></figure>
<p>/proc 目录中记录的整个操作系统的运行统计和信息</p>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><p>命令行提供通配符（wildcards），类似bash中正则表达式的用法，可以简洁地表示复杂模式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ll ?.py <span class="comment"># ?表示单个字符但是不能匹配空字符，??表示两个字符，以此类推。通配符是先解释，再执行</span></span><br><span class="line">ll *.py <span class="comment"># *表示数量任意的字符，可以匹配空字符。只能用于单层路径</span></span><br><span class="line">ls */*.py <span class="comment"># 匹配包括子目录</span></span><br><span class="line">ll [xyz].py <span class="comment"># 表示匹配[xyz]中任意字符，如果找不到匹配，[xyz]变成一个单纯的字符串</span></span><br><span class="line">ll *[xyz].py <span class="comment"># 匹配后续为[xyz].py字符</span></span><br><span class="line">ll [1-9].py</span><br><span class="line">ll [a-z].py</span><br><span class="line">ll [^xyz].py <span class="comment"># 匹配不在[xyz].py里的文件</span></span><br><span class="line">ll [!xyz].py <span class="comment"># 同上</span></span><br><span class="line">ll [^x-z].py <span class="comment"># 同上，使用[x-z]表达</span></span><br><span class="line"><span class="built_in">echo</span> *.pyc <span class="comment"># 如果无法解释，会输出*.pyc</span></span><br><span class="line"><span class="built_in">echo</span> &#123;a,b,c&#125; <span class="comment"># a b c</span></span><br><span class="line"><span class="built_in">echo</span> &#123;a,b,c&#125;xyz <span class="comment"># axyz bxyz cxyz</span></span><br><span class="line"><span class="built_in">echo</span> &#123;a,b,c&#125;&#123;x,y,z&#125; <span class="comment"># ax ay az bx by bz cx cy cz</span></span><br><span class="line"><span class="built_in">echo</span> &#123;&#123;0..9&#125;,&#123;a..z&#125;&#125; <span class="comment"># 0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z</span></span><br><span class="line">ll &#123;x,y,z&#125;.py <span class="comment"># 匹配[xyz].py，如果无法匹配也会展开</span></span><br><span class="line"><span class="built_in">echo</span> &#123;1..9&#125;a <span class="comment"># 1a 2a 3a 4a 5a 6a 7a 8a 9a</span></span><br><span class="line"><span class="built_in">echo</span> &#123;a..z&#125;&#123;1..9&#125; <span class="comment"># a1 a2 a3 ... z7 z8 z9</span></span><br></pre></td></tr></table></figure>
<p>这里需要注意，<code>[...]</code>如果无法匹配，会当做普通字符串，而<code>{...}</code>无论如何也会展开。</p>
<p><code>ll *.py</code>会先被bash解析，进行匹配扩展如<code>x</code>，然后再执行普通命令<code>ll x.py</code>。</p>
<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">touch <span class="variable">$&#123;file&#125;</span> <span class="comment"># 创建文件</span></span><br><span class="line">&gt; <span class="variable">$&#123;file&#125;</span> <span class="comment"># 创建文件</span></span><br><span class="line">file -i <span class="variable">$filename</span> <span class="comment"># 文件编码</span></span><br><span class="line">wc -l</span><br><span class="line"><span class="built_in">cd</span> - <span class="comment"># 回到上一次目录</span></span><br><span class="line"><span class="built_in">cd</span> ~ <span class="comment"># 回到HOME</span></span><br><span class="line">du -s * | sort -n | tail <span class="comment"># 列出当前目录里最大的10个文件</span></span><br><span class="line">ldd <span class="variable">$&#123;file&#125;</span> <span class="comment"># 可执行文件使用的动态链接库</span></span><br></pre></td></tr></table></figure>
<h3 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=/dev/zero of=<span class="variable">$&#123;file&#125;</span> bs=10M count=100 <span class="comment"># 创建10*100M大小的$&#123;file&#125;内容从/dev/zero读取</span></span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=<span class="variable">$&#123;file&#125;</span> bs=1M count=0 seek=100 <span class="comment"># 同上，但用seek跳过，但并不占用实际空间，可以用du -s $&#123;file&#125;来测试</span></span><br></pre></td></tr></table></figure>
<h3 id="查找命令"><a href="#查找命令" class="headerlink" title="查找命令"></a>查找命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">find <span class="variable">$&#123;path&#125;</span> <span class="variable">$&#123;cond&#125;</span> <span class="variable">$&#123;act&#125;</span> <span class="comment"># find的用法模板</span></span><br><span class="line">find . -name <span class="string">'*.py'</span> <span class="comment"># 在当前目录和子目录查找py后缀文件，默认搜索普通文件+特殊文件+目录</span></span><br><span class="line">find . -<span class="built_in">type</span> f -name <span class="string">"python"</span> <span class="comment"># 同上，不过type指定是普通文件</span></span><br><span class="line">find . -<span class="built_in">type</span> d -name <span class="string">"python"</span> <span class="comment"># 同上，指定目录</span></span><br><span class="line">find . -ls -name <span class="string">'*.py'</span> <span class="comment"># 在当前目录和子目录查找py后缀文件并列出详细信息</span></span><br><span class="line">locate /etc/docker <span class="comment"># 搜索/etc/docker为前缀的文件。locate命令不遍历目录，而是搜索/var/lib/locatedb数据库</span></span><br><span class="line">updatedb <span class="comment"># 更新/var/lib/locatedb数据库</span></span><br><span class="line">whereis <span class="variable">$&#123;program&#125;</span> <span class="comment"># 搜索program所在位置</span></span><br><span class="line"><span class="built_in">which</span> <span class="variable">$&#123;program&#125;</span> <span class="comment"># 搜索program所在位置</span></span><br><span class="line"><span class="built_in">type</span> <span class="variable">$&#123;program&#125;</span> <span class="comment"># 判别是shell还是二进制执行文件</span></span><br></pre></td></tr></table></figure>
<p>whereis vs which vs type</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ whereis docker</span><br><span class="line">docker: /usr/bin/docker /etc/docker /usr/libexec/docker /usr/share/man/man1/docker.1.gz</span><br><span class="line">$ <span class="built_in">which</span> docker</span><br><span class="line">/usr/bin/docker</span><br><span class="line">$ <span class="built_in">type</span> docker</span><br><span class="line">docker 是 /usr/bin/docker</span><br><span class="line">$ <span class="built_in">type</span> ll</span><br><span class="line">ll 是“ls -alF”的别名</span><br></pre></td></tr></table></figure>
<h3 id="apt包"><a href="#apt包" class="headerlink" title="apt包"></a>apt包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">apt install <span class="comment"># 安装软件包</span></span><br><span class="line">apt remove <span class="comment"># 移除软件包</span></span><br><span class="line">apt purge <span class="comment"># 移除软件包及配置文件</span></span><br><span class="line">apt update <span class="comment"># 刷新存储库索引</span></span><br><span class="line">apt upgrade <span class="comment"># 升级所有可升级的软件包</span></span><br><span class="line">apt autoremove <span class="comment"># 自动删除不需要的包</span></span><br><span class="line">apt full-upgrade <span class="comment"># 在升级软件包时自动处理依赖关系</span></span><br><span class="line">apt search <span class="comment"># 搜索应用程序</span></span><br><span class="line">apt show <span class="comment"># 显示装细节9</span></span><br></pre></td></tr></table></figure>
<h3 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="文件防伪"><a href="#文件防伪" class="headerlink" title="文件防伪"></a>文件防伪</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md5sum <span class="variable">$&#123;file&#125;</span></span><br><span class="line">sha1sum <span class="variable">$&#123;file&#125;</span></span><br><span class="line">sha256sum <span class="variable">$&#123;file&#125;</span> <span class="comment"># MAC OS使用shasum -a256</span></span><br></pre></td></tr></table></figure>
<p><a href="https://www.ruanyifeng.com/blog/2013/07/gpg.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2013/07/gpg.html</a></p>
<h3 id="压缩与解压"><a href="#压缩与解压" class="headerlink" title="压缩与解压"></a>压缩与解压</h3><h2 id="网络操作"><a href="#网络操作" class="headerlink" title="网络操作"></a>网络操作</h2><h3 id="net-tools网络工具"><a href="#net-tools网络工具" class="headerlink" title="net-tools网络工具"></a>net-tools网络工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ifconfig -a <span class="comment"># ifconfig是net-tools网络工具的命令</span></span><br><span class="line">netstat -a <span class="comment"># 列出所有端口 </span></span><br><span class="line">netstat -at <span class="comment"># 列出所有tcp端口 </span></span><br><span class="line">netstat -au <span class="comment"># 列出所有udp端口 </span></span><br><span class="line">netstat -l <span class="comment"># 只显示监听端口 </span></span><br><span class="line">netstat -lt <span class="comment"># 只列出所有监听 TCP 端口 </span></span><br><span class="line">netstat -lu <span class="comment"># 只列出所有监听 UDP 端口 </span></span><br><span class="line">netstat -lx <span class="comment"># 只列出所有监听 UNIX 端口</span></span><br><span class="line">netstat -tlnp <span class="comment"># 列出本机进程监听的端口号</span></span><br></pre></td></tr></table></figure>
<h3 id="iproute2套装工具"><a href="#iproute2套装工具" class="headerlink" title="iproute2套装工具"></a>iproute2套装工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ip addr <span class="comment"># 网卡细节，地址</span></span><br><span class="line">ip link <span class="comment"># LINK</span></span><br><span class="line">ip -s link</span><br><span class="line">ip addr add 192.168.0.193/24 dev wlan0 <span class="comment"># 为设备wlan0设置IP地址</span></span><br><span class="line">ip addr show wlan0</span><br><span class="line">ip addr del 192.168.0.193/24 dev wlan0</span><br><span class="line">ip route show <span class="comment"># 列出路由表条目</span></span><br></pre></td></tr></table></figure>
<p>网络质量测试</p>
<p>网速测试、网络流量，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nload <span class="variable">$&#123;device&#125;</span> <span class="comment"># 查看网卡流量，可以用`ip addr show`获得网卡信息</span></span><br><span class="line">nethogs <span class="comment"># 查看进程流量</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nmap &#123;IP&#125; <span class="comment"># 扫描端口</span></span><br><span class="line">nmap -sn 192.168.1.0/24</span><br><span class="line">traceroute <span class="variable">$&#123;address&#125;</span> <span class="comment"># 跟踪路由</span></span><br><span class="line">mtr <span class="variable">$&#123;address&#125;</span> <span class="comment"># 类似于traceroute，但是动态监控信息</span></span><br><span class="line">lsof -i <span class="comment"># 本机网络服务的活动实时状态</span></span><br></pre></td></tr></table></figure>
<h3 id="DNS有关的操作"><a href="#DNS有关的操作" class="headerlink" title="DNS有关的操作"></a>DNS有关的操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/resolv.conf</span><br><span class="line">( nmcli dev list || nmcli dev show ) 2&gt;/dev/null | grep DNS <span class="comment"># 获取DNS</span></span><br><span class="line">systemd-resolve --status | grep DNS</span><br><span class="line">resolvectl dns <span class="variable">$&#123;device&#125;</span> 8.8.8.8 <span class="comment"># 使用resolvectl设置DNS</span></span><br></pre></td></tr></table></figure>
<h3 id="rsync"><a href="#rsync" class="headerlink" title="rsync"></a>rsync</h3><p>rsyn同时支持本地和远程目录的<strong>增量同步</strong>，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sync -r <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># r表示递归，从source到destination，后者可以是username@remote_host:destination格式，进而支持远程同步</span></span><br><span class="line">sync -a <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># a表示递归+同步元信息，从source到destination</span></span><br><span class="line">sync -avn <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># v表示将操作结果输出到终端，n表示模拟从source到destination</span></span><br><span class="line">rsync -av --delete <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># delete参数表示删除只存在于destination目录（副本）、不存在于source目录的文件</span></span><br><span class="line">rsync -av --exclude=<span class="string">'*.pyc'</span> <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># 排除*.pyc文件</span></span><br><span class="line">rsync -av --exclude=<span class="string">'__pycache__/*'</span> <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># 排除__pycache__目录里的文件（不包括目录）</span></span><br><span class="line">rsync -av --exclude=&#123;<span class="string">'*.pyc'</span>,<span class="string">'*.pyo'</span>&#125; <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># 排除多个模式文件，当模式很多，可以用--exclude-from指定存放模式的文件</span></span><br><span class="line">rsync -av -e <span class="string">'ssh -p 8899'</span> <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;destination&#125;</span> <span class="comment"># 指定具体的ssh参数</span></span><br><span class="line">rsync -av <span class="variable">$&#123;source&#125;</span> <span class="variable">$&#123;IP&#125;</span>::<span class="variable">$&#123;module&#125;</span>/<span class="variable">$&#123;destination&#125;</span> <span class="comment"># 和$&#123;IP&#125;上的rsync进程通信，$&#123;module&#125;使其资源名</span></span><br></pre></td></tr></table></figure>
<h3 id="curl-amp-wget"><a href="#curl-amp-wget" class="headerlink" title="curl &amp; wget"></a>curl &amp; wget</h3><p>curl用来请求Web服务器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="variable">$&#123;address&#125;</span> <span class="comment"># 访问地址</span></span><br><span class="line">curl ifconfig.me <span class="comment"># curl查看本机外网地址</span></span><br><span class="line">curl --referer <span class="variable">$&#123;x_address&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 指定中x_address到address访问</span></span><br><span class="line">curl --user-agent <span class="variable">$&#123;UA&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 指定UA</span></span><br><span class="line">curl --user name:password <span class="variable">$&#123;address&#125;</span></span><br><span class="line">curl --header <span class="string">"Content-Type:application/json"</span> <span class="variable">$&#123;address&#125;</span></span><br><span class="line">curl --cookie <span class="string">"<span class="variable">$&#123;key&#125;</span>=<span class="variable">$&#123;value&#125;</span>"</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 指定cookie</span></span><br><span class="line">curl -c <span class="variable">$&#123;file&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 保存cookie到文件</span></span><br><span class="line">curl -b <span class="variable">$&#123;file&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 加载文件作为cookie</span></span><br><span class="line">curl -o <span class="variable">$&#123;file&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 保存到文件</span></span><br><span class="line">curl -i <span class="variable">$&#123;address&#125;</span> <span class="comment"># 支持显示HTTP的Response信息</span></span><br><span class="line">curl -V <span class="variable">$&#123;address&#125;</span> <span class="comment"># 显示HTTP通信的整个过程，包括端口连接和Request、Response信息</span></span><br><span class="line">curl -L <span class="variable">$&#123;address&#125;</span> <span class="comment"># L支持自动跳转</span></span><br><span class="line">curl --trace <span class="variable">$&#123;file&#125;</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 更详细的信息输出到文件</span></span><br><span class="line">curl <span class="variable">$&#123;address&#125;</span>?a=b <span class="comment"># GET方法发送表单，例如curl -L www.google.com/search?q=curl</span></span><br><span class="line">curl -X POST --data <span class="string">"<span class="variable">$&#123;key&#125;</span>=<span class="variable">$&#123;value&#125;</span>"</span> <span class="variable">$&#123;address&#125;</span> <span class="comment"># 通过POST方法提交表单，X表示HTTP访问方法，如DELETE、POST。--data-urlencode编码表单</span></span><br></pre></td></tr></table></figure>
<p>如果不想用命令行，Postman是推荐的UI工具。</p>
<h3 id="ssh相关"><a href="#ssh相关" class="headerlink" title="ssh相关"></a>ssh相关</h3><p>ssh登录过程：</p>
<ul>
<li>服务器收到用户的登录请求，其把自己的公钥发给用户</li>
<li>用户收到公钥后，将登录密码使用公钥加密后，发送到服务器</li>
<li>服务器用自己的私钥，解密用户的登录密码，验证密码通过，用户登录成功</li>
</ul>
<p>这个过程有中间人攻击风险，攻击者冒充服务器，伪造假的公钥发送给用户，用户无法辨别公钥真伪，攻击者进而接管登录过程，获取用户密码。因此，使用公钥指纹来辨别公钥的所有者是一种简单的用法。只需要服务器的所有者公开公钥的指纹即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ssh <span class="variable">$&#123;user&#125;</span>@<span class="variable">$&#123;host&#125;</span> <span class="comment"># 默认用法，端口是22</span></span><br><span class="line">ssh -l <span class="variable">$&#123;user&#125;</span> <span class="variable">$&#123;host&#125;</span> <span class="comment"># 同上</span></span><br><span class="line">ssh -p <span class="variable">$&#123;port&#125;</span> <span class="variable">$&#123;user&#125;</span>@<span class="variable">$&#123;host&#125;</span> <span class="comment"># 指定端口</span></span><br><span class="line">tar czv src | ssh user@host <span class="string">'tar xz'</span></span><br><span class="line">ssh user@host <span class="string">'tar cz src'</span> | tar xzv</span><br><span class="line">ssh user@host <span class="string">'ps ax | grep [h]ttpd'</span></span><br><span class="line">ssh user@host cat /path/to/remotefile | diff /path/to/localfile - <span class="comment"># 比较一个远程文件和一个本地文件</span></span><br><span class="line">ssh user@server bash &lt; /path/to/<span class="built_in">local</span>/script.sh <span class="comment"># 在远程机器上运行一段脚本。这条命令最大的好处就是不用把脚本拷到远程机器上</span></span><br></pre></td></tr></table></figure>
<p>为避免每次登录服务器进行的公钥验证，用户可以使用公钥登录：</p>
<ul>
<li>用户首次登录将自己的公钥储存到服务器上</li>
<li>下次登录的时候，服务器向用户发送一段随机字符串，用户用自己的私钥加密后该字符串，再发回来服务器</li>
<li>远程主机用已经储存的公钥进行解密，验证随机字符串是否匹配，匹配就证明用户是可信，于是登录成功</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id <span class="variable">$&#123;user&#125;</span>@<span class="variable">$&#123;host&#125;</span></span><br><span class="line">ssh-keygen -R <span class="variable">$&#123;hostname&#125;</span> <span class="comment"># 将原来的公钥指纹从~/.ssh/known_hosts文件清除</span></span><br><span class="line">ssh-keygen -l -f <span class="variable">$&#123;key&#125;</span>.pub <span class="comment"># 查看公钥的指纹和加密方式</span></span><br></pre></td></tr></table></figure>
<p>避免SSH连接超时而断开或卡死，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/ssh/ssh_config <span class="comment"># 修改一下参数，连接SSH到服务器后，每60秒会发一个KeepAlive请求</span></span><br><span class="line">ServerAliveInterval 60</span><br><span class="line"></span><br><span class="line">cat /etc/ssh/sshd_config <span class="comment"># 另外一个参考选择</span></span><br><span class="line">ClientAliveInterval 60</span><br></pre></td></tr></table></figure>
<p>端口转发</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -D <span class="variable">$&#123;port&#125;</span> <span class="variable">$&#123;user&#125;</span>@<span class="variable">$&#123;host&#125;</span> <span class="comment"># 绑定本地端口</span></span><br><span class="line">ssh -L <span class="variable">$&#123;local_port&#125;</span>:<span class="variable">$&#123;target_host&#125;</span>:<span class="variable">$&#123;target_port&#125;</span> <span class="variable">$&#123;forward_host&#125;</span> <span class="comment"># 本地端口转发，SSH隧道</span></span><br></pre></td></tr></table></figure>
<p>远程端口转发</p>
<p>限制sshd的登录IP地址的方法</p>
<p>在<code>/etc/hosts.allow</code>添加如下项目,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshd: <span class="variable">$&#123;your_address&#125;</span>:allow</span><br></pre></td></tr></table></figure>
<p>可以允许<code>${your_address}</code>登录。</p>
<p>在<code>/etc/hosts.deny</code>输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshd: <span class="variable">$&#123;your_deny_address&#125;</span></span><br></pre></td></tr></table></figure>
<p>于是，可以限制登录<code>${your_deny_address}</code>地址</p>
<p>如果两个文件的配置有冲突，以<code>/etc/hosts.deny</code>为准</p>
<h2 id="日志和数据处理"><a href="#日志和数据处理" class="headerlink" title="日志和数据处理"></a>日志和数据处理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tail -f /var/<span class="built_in">log</span>/xx/yy.log</span><br><span class="line">cat <span class="variable">$&#123;file&#125;</span></span><br><span class="line">nl <span class="variable">$&#123;file&#125;</span> <span class="comment"># 类似于cat但带行号</span></span><br><span class="line">tail -f /path/to/file.log | sed <span class="string">'/^Finished: SUCCESS$/ q'</span> <span class="comment"># 实时监控并过滤log是否出现了某条记录</span></span><br><span class="line">sort</span><br><span class="line">uniq</span><br></pre></td></tr></table></figure>
<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>awk用于处理文本文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="variable">$&#123;act&#125;</span> <span class="variable">$&#123;file&#125;</span> <span class="comment"># awk的使用模板</span></span><br><span class="line">awk <span class="variable">$&#123;cond act&#125;</span> <span class="variable">$&#123;file&#125;</span> <span class="comment"># 允许指定输出条件，只输出符合条件的行</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;string&#125;</span> | awk <span class="variable">$&#123;act&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;file&#125;</span> | awk <span class="variable">$&#123;act&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a b c'</span> | awk <span class="string">'&#123;print $0&#125;'</span> <span class="comment"># $0表示把标准输入直接输出</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a b c'</span> | awk <span class="string">'&#123;print $1&#125;'</span> <span class="comment"># $1表示以空格为分割，输出第一个元素，以此类推，如果超出范围返回空</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a b c'</span> | awk <span class="string">'&#123;print $NF&#125;'</span> <span class="comment"># NF变量表示最后一个元素，即c</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a b c'</span> | awk <span class="string">'&#123;print $(NF-1)&#125;'</span> <span class="comment"># 返回倒数第二个即b，以此类推</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a:b:c'</span> | awk -F <span class="string">':'</span> <span class="string">'&#123;print $1&#125;'</span> <span class="comment"># 可以指定分隔</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a:b:c'</span> | awk -F <span class="string">':'</span> <span class="string">'&#123;print $1&#125;&#123;print $2&#125;'</span> <span class="comment"># 可以指定多个命令，返回ab（ab之间换行）</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a:b:c'</span> | awk -F <span class="string">':'</span> <span class="string">'&#123;print $1, $2&#125;'</span> <span class="comment"># 可以指定多个命令，返回a b（不换行）</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'a:b:c'</span> | awk -F <span class="string">':'</span> <span class="string">'&#123;print $1 $2&#125;'</span> <span class="comment"># ab（中间没有空格）</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'A B C'</span> | awk <span class="string">'&#123;print tolower($1)&#125;'</span> <span class="comment"># 执行tolower函数</span></span><br><span class="line">cat *.py | awk <span class="string">'/import/ &#123;print $2&#125;'</span> <span class="comment"># /import/表示条件，输出只包括import的行</span></span><br><span class="line"><span class="built_in">history</span>|awk <span class="string">'&#123;print $2&#125;'</span>| awk <span class="string">'BEGIN &#123;FS="|"&#125; &#123;print $1&#125;'</span>|sort|uniq -c|sort -rn|head -10 <span class="comment"># 统计命令</span></span><br></pre></td></tr></table></figure>
<p>NR变量表示输出的行序号，从1开始计数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ ps -aux | head | awk <span class="string">'&#123;print NR "-" $2&#125;'</span></span><br><span class="line">1-PID</span><br><span class="line">2-1</span><br><span class="line">3-2</span><br><span class="line">4-3</span><br><span class="line">5-4</span><br><span class="line">6-6</span><br><span class="line">7-9</span><br><span class="line">8-10</span><br><span class="line">9-11</span><br><span class="line">10-12</span><br></pre></td></tr></table></figure>
<h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><p>sed是流编辑器，比awk出现早几年。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>转载请包括本文地址：<a href="../6329">https://allenwind.github.io/blog/6329</a><br>更多文章请参考：<a href="../archives/">https://allenwind.github.io/blog/archives/</a></p>
</div><div class="tags"><a href="/blog/tags/Linux/">Linux</a><a href="/blog/tags/命令行/">命令行</a></div><div class="post-nav"><a class="pre" href="/blog/6336/">一个绝妙的idea：变长文本序列转换成定长向量</a><a class="next" href="/blog/6220/">ZFS文件系统中的ARC缓存算法</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://allenwind.github.io/blog"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/C-C/">C/C++</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Go/">Go</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/NLP/">NLP</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/数学/">数学</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/数据库/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/数据结构和算法/">数据结构和算法</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/机器学习深度学习/">机器学习深度学习</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/记录/">记录</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/blog/tags/算法/" style="font-size: 15px;">算法</a> <a href="/blog/tags/C/" style="font-size: 15px;">C</a> <a href="/blog/tags/Python/" style="font-size: 15px;">Python</a> <a href="/blog/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/blog/tags/C语言/" style="font-size: 15px;">C语言</a> <a href="/blog/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/blog/tags/区块链/" style="font-size: 15px;">区块链</a> <a href="/blog/tags/分布式/" style="font-size: 15px;">分布式</a> <a href="/blog/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/blog/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/blog/tags/NoSQL/" style="font-size: 15px;">NoSQL</a> <a href="/blog/tags/sudo/" style="font-size: 15px;">sudo</a> <a href="/blog/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/blog/tags/ACID/" style="font-size: 15px;">ACID</a> <a href="/blog/tags/git/" style="font-size: 15px;">git</a> <a href="/blog/tags/Git/" style="font-size: 15px;">Git</a> <a href="/blog/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/blog/tags/gcc/" style="font-size: 15px;">gcc</a> <a href="/blog/tags/Systemd/" style="font-size: 15px;">Systemd</a> <a href="/blog/tags/Tensorflow/" style="font-size: 15px;">Tensorflow</a> <a href="/blog/tags/命令行/" style="font-size: 15px;">命令行</a> <a href="/blog/tags/网络/" style="font-size: 15px;">网络</a> <a href="/blog/tags/记录/" style="font-size: 15px;">记录</a> <a href="/blog/tags/操作系统/" style="font-size: 15px;">操作系统</a> <a href="/blog/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/blog/tags/数据结构/" style="font-size: 15px;">数据结构</a> <a href="/blog/tags/Go/" style="font-size: 15px;">Go</a> <a href="/blog/tags/go/" style="font-size: 15px;">go</a> <a href="/blog/tags/Java/" style="font-size: 15px;">Java</a> <a href="/blog/tags/LRU/" style="font-size: 15px;">LRU</a> <a href="/blog/tags/ARC/" style="font-size: 15px;">ARC</a> <a href="/blog/tags/搜索引擎/" style="font-size: 15px;">搜索引擎</a> <a href="/blog/tags/剑指Offer/" style="font-size: 15px;">剑指Offer</a> <a href="/blog/tags/函数式/" style="font-size: 15px;">函数式</a> <a href="/blog/tags/Stack/" style="font-size: 15px;">Stack</a> <a href="/blog/tags/并发编程/" style="font-size: 15px;">并发编程</a> <a href="/blog/tags/网络编程/" style="font-size: 15px;">网络编程</a> <a href="/blog/tags/并发/" style="font-size: 15px;">并发</a> <a href="/blog/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/blog/tags/装饰器/" style="font-size: 15px;">装饰器</a> <a href="/blog/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/blog/tags/数学/" style="font-size: 15px;">数学</a> <a href="/blog/tags/度量/" style="font-size: 15px;">度量</a> <a href="/blog/tags/时间序列/" style="font-size: 15px;">时间序列</a> <a href="/blog/tags/投资/" style="font-size: 15px;">投资</a> <a href="/blog/tags/概率/" style="font-size: 15px;">概率</a> <a href="/blog/tags/统计/" style="font-size: 15px;">统计</a> <a href="/blog/tags/信息论/" style="font-size: 15px;">信息论</a> <a href="/blog/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/blog/tags/贝叶斯/" style="font-size: 15px;">贝叶斯</a> <a href="/blog/tags/最小二乘法/" style="font-size: 15px;">最小二乘法</a> <a href="/blog/tags/分布/" style="font-size: 15px;">分布</a> <a href="/blog/tags/深度学习/" style="font-size: 15px;">深度学习</a> <a href="/blog/tags/变分推断/" style="font-size: 15px;">变分推断</a> <a href="/blog/tags/随机/" style="font-size: 15px;">随机</a> <a href="/blog/tags/不等式/" style="font-size: 15px;">不等式</a> <a href="/blog/tags/采样/" style="font-size: 15px;">采样</a> <a href="/blog/tags/光滑/" style="font-size: 15px;">光滑</a> <a href="/blog/tags/逼近/" style="font-size: 15px;">逼近</a> <a href="/blog/tags/矩阵/" style="font-size: 15px;">矩阵</a> <a href="/blog/tags/特征工程/" style="font-size: 15px;">特征工程</a> <a href="/blog/tags/交叉验证/" style="font-size: 15px;">交叉验证</a> <a href="/blog/tags/集成学习/" style="font-size: 15px;">集成学习</a> <a href="/blog/tags/分类/" style="font-size: 15px;">分类</a> <a href="/blog/tags/证明/" style="font-size: 15px;">证明</a> <a href="/blog/tags/损失函数/" style="font-size: 15px;">损失函数</a> <a href="/blog/tags/回归/" style="font-size: 15px;">回归</a> <a href="/blog/tags/词向量/" style="font-size: 15px;">词向量</a> <a href="/blog/tags/信息/" style="font-size: 15px;">信息</a> <a href="/blog/tags/正则化/" style="font-size: 15px;">正则化</a> <a href="/blog/tags/NLP/" style="font-size: 15px;">NLP</a> <a href="/blog/tags/Embedding/" style="font-size: 15px;">Embedding</a> <a href="/blog/tags/神经网络/" style="font-size: 15px;">神经网络</a> <a href="/blog/tags/Transformer/" style="font-size: 15px;">Transformer</a> <a href="/blog/tags/Attention/" style="font-size: 15px;">Attention</a> <a href="/blog/tags/对抗训练/" style="font-size: 15px;">对抗训练</a> <a href="/blog/tags/文本分类/" style="font-size: 15px;">文本分类</a> <a href="/blog/tags/分词/" style="font-size: 15px;">分词</a> <a href="/blog/tags/并行/" style="font-size: 15px;">并行</a> <a href="/blog/tags/NER/" style="font-size: 15px;">NER</a> <a href="/blog/tags/HMM/" style="font-size: 15px;">HMM</a> <a href="/blog/tags/图/" style="font-size: 15px;">图</a> <a href="/blog/tags/概率图/" style="font-size: 15px;">概率图</a> <a href="/blog/tags/可视化/" style="font-size: 15px;">可视化</a> <a href="/blog/tags/梯度/" style="font-size: 15px;">梯度</a> <a href="/blog/tags/RNN/" style="font-size: 15px;">RNN</a> <a href="/blog/tags/LSTM/" style="font-size: 15px;">LSTM</a> <a href="/blog/tags/注意力/" style="font-size: 15px;">注意力</a> <a href="/blog/tags/序列编码/" style="font-size: 15px;">序列编码</a> <a href="/blog/tags/磁盘故障/" style="font-size: 15px;">磁盘故障</a> <a href="/blog/tags/BERT/" style="font-size: 15px;">BERT</a> <a href="/blog/tags/优化/" style="font-size: 15px;">优化</a> <a href="/blog/tags/CNN/" style="font-size: 15px;">CNN</a> <a href="/blog/tags/卷积/" style="font-size: 15px;">卷积</a> <a href="/blog/tags/调参/" style="font-size: 15px;">调参</a> <a href="/blog/tags/Flask/" style="font-size: 15px;">Flask</a> <a href="/blog/tags/web/" style="font-size: 15px;">web</a> <a href="/blog/tags/socket/" style="font-size: 15px;">socket</a> <a href="/blog/tags/安全/" style="font-size: 15px;">安全</a> <a href="/blog/tags/协程/" style="font-size: 15px;">协程</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/16003/">天马行空：设计自己的激活函数</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/15887/">函数光滑近似（4）：Heaviside step函数及其应用</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/15205/">引入参数控制softmax的smooth程度</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/15110/">分析与拓展：多分类模型的输出为什么使用softmax？</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/14990/">一种基于光滑逼近的正态分布采样法</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/14721/">GELU由来：从狄拉克函数到GELU激活函数</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/14465/">Lp范数的上下界分析</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/14441/">logsumexp函数分析</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/14133/">分析Mish激活函数的设计思路</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/13899/">阿尔法经济学：Shiller模型介绍</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/allenwind" title="My GitHub" target="_blank">My GitHub</a><ul></ul><a href="http://www.arxiv-sanity.com/" title="arxiv-sanity" target="_blank">arxiv-sanity</a><ul></ul><a href="https://arxiv.org/" title="arxiv.org" target="_blank">arxiv.org</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/blog/." rel="nofollow">Mr.Feng Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=0.0.0"></script></div></body></html>